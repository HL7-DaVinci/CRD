(this.webpackJsonpNode_Interfaces=this.webpackJsonpNode_Interfaces||[]).push([[0],{127:function(e,t,a){},18:function(e,t){e.exports={getBaseUrl:function(){var e=document.querySelector("meta[name='ctx']").getAttribute("content");return"string"!==typeof e&&(e="/"),e.endsWith("/")||(e+="/"),e.startsWith("/")||(e="/"+e),e},getBackend:function(){var e=document.querySelector("meta[name='backend']").getAttribute("content");return"string"!==typeof e&&(e="/"),e.endsWith("/")||(e+="/"),e},getHostOrg:function(){return document.querySelector("meta[name='hostorg']").getAttribute("content")}}},190:function(e,t,a){e.exports=a(372)},195:function(e,t,a){},197:function(e,t,a){e.exports=a.p+"static/media/logo.5d5d9eef.svg"},198:function(e,t,a){},200:function(e,t,a){},206:function(e,t,a){},21:function(e,t){e.exports={grant_type:"authorization_code",stateOptions:[{key:"AL",value:"AL",text:"Alabama"},{key:"AK",value:"AK",text:"Alaska"},{key:"AZ",value:"AZ",text:"Arizona"},{key:"AR",value:"AR",text:"Arkansas"},{key:"CA",value:"CA",text:"California"},{key:"CO",value:"CO",text:"Colorado"},{key:"CT",value:"CT",text:"Connecticut"},{key:"DE",value:"DE",text:"Delaware"},{key:"DC",value:"DC",text:"District Of Columbia"},{key:"FL",value:"FL",text:"Florida"},{key:"GA",value:"GA",text:"Georgia"},{key:"HI",value:"HI",text:"Hawaii"},{key:"ID",value:"ID",text:"Idaho"},{key:"IL",value:"IL",text:"Illinois"},{key:"IN",value:"IN",text:"Indiana"},{key:"IA",value:"IA",text:"Iowa"},{key:"KS",value:"KS",text:"Kansas"},{key:"KY",value:"KY",text:"Kentucky"},{key:"LA",value:"LA",text:"Louisiana"},{key:"ME",value:"ME",text:"Maine"},{key:"MD",value:"MD",text:"Maryland"},{key:"MA",value:"MA",text:"Massachusetts"},{key:"MI",value:"MI",text:"Michigan"},{key:"MN",value:"MN",text:"Minnesota"},{key:"MS",value:"MS",text:"Mississippi"},{key:"MO",value:"MO",text:"Missouri"},{key:"MT",value:"MT",text:"Montana"},{key:"NE",value:"NE",text:"Nebraska"},{key:"NV",value:"NV",text:"Nevada"},{key:"NH",value:"NH",text:"New Hampshire"},{key:"NJ",value:"NJ",text:"New Jersey"},{key:"NM",value:"NM",text:"New Mexico"},{key:"NY",value:"NY",text:"New York"},{key:"NC",value:"NC",text:"North Carolina"},{key:"ND",value:"ND",text:"North Dakota"},{key:"OH",value:"OH",text:"Ohio"},{key:"OK",value:"OK",text:"Oklahoma"},{key:"OR",value:"OR",text:"Oregon"},{key:"PA",value:"PA",text:"Pennsylvania"},{key:"RI",value:"RI",text:"Rhode Island"},{key:"SC",value:"SC",text:"South Carolina"},{key:"SD",value:"SD",text:"South Dakota"},{key:"TN",value:"TN",text:"Tennessee"},{key:"TX",value:"TX",text:"Texas"},{key:"UT",value:"UT",text:"Utah"},{key:"VT",value:"VT",text:"Vermont"},{key:"VA",value:"VA",text:"Virginia"},{key:"WA",value:"WA",text:"Washington"},{key:"WV",value:"WV",text:"West Virginia"},{key:"WI",value:"WI",text:"Wisconsin"},{key:"WY",value:"WY",text:"Wyoming"}],coverageCodes:[{key:"group",value:"group",text:"Group"},{key:"subgroup",value:"subgroup",text:"SubGroup"},{key:"plan",value:"plan",text:"Plan"},{key:"subplan",value:"subplan",text:"SubPlan"},{key:"class",value:"class",text:"Class"},{key:"subclass",value:"subclass",text:"SubClass"},{key:"sequence",value:"sequence",text:"Sequence"},{key:"rxbin",value:"rxbin",text:"RX BIN"},{key:"rxpcn",value:"rxpcn",text:"RX PCN"},{key:"rxid",value:"rxid",text:"RX Id"},{key:"rxgroup",value:"rxgroup",text:"RX Group"}],codeSystems:[{key:"hcpcs",value:"https://bluebutton.cms.gov/resources/codesystem/hcpcs",text:"HCPCS"},{key:"cpt",value:"http://www.ama-assn.org/go/cpt",text:"CPT"},{key:"rxnorm",value:"http://www.nlm.nih.gov/research/umls/rxnorm",text:"RxNorm"}],hcpcsCodes:[{key:"A0426",value:"A0426",text:"A0426"},{key:"A5500",value:"A5500",text:"A5500"},{key:"E0110",value:"E0110",text:"E0110"},{key:"E0130",value:"E0130",text:"E0130"},{key:"E0250",value:"E0250",text:"E0250"},{key:"E0424",value:"E0424",text:"E0424"},{key:"E0431",value:"E0431",text:"E0431"},{key:"E0433",value:"E0433",text:"E0433"},{key:"E0434",value:"E0434",text:"E0434"},{key:"E0439",value:"E0439",text:"E0439"},{key:"E0441",value:"E0441",text:"E0441"},{key:"E0442",value:"E0442",text:"E0442"},{key:"E0443",value:"E0443",text:"E0443"},{key:"E0444",value:"E0444",text:"E0444"},{key:"E0465",value:"E0465",text:"E0465"},{key:"E0470",value:"E0470",text:"E0470"},{key:"E0601",value:"E0601",text:"E0601"},{key:"E1390",value:"E1390",text:"E1390"},{key:"E1391",value:"E1391",text:"E1391"},{key:"E1392",value:"E1392",text:"E1392"},{key:"K0738",value:"K0738",text:"K0738"}],cptCodes:[{key:"82947",value:"82947",text:"82947"},{key:"94649",value:"94649",text:"94649"},{key:"94660",value:"94660",text:"94660"},{key:"95259",value:"95259",text:"95259"},{key:"97542",value:"97542",text:"97542"}],rxNormCodes:[{key:"209431",value:"209431",text:"209431"},{key:"860195",value:"860195",text:"860195"}],organizations:[{key:"medicare",value:"Centers for Medicare and Medicaid Services",text:"Centers for Medicare and Medicaid Services"}]}},318:function(e,t,a){},372:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(13),s=a.n(i),o=(a(195),a(196),a(8)),c=a(7),l=a(9),u=a(10),d=a(11),h=(a(197),a(198),a(419)),m=a(22),p=a.n(m),v=a(46),f=a(5),b=(a(200),a(63),a(421)),y=(a(77),a(71)),g=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={requestInfo:{}},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.data;this.setState({requestInfo:{age:e.patientAge,gender:e.patientGender,"Patient State":e.patientAddressState,"Provider State":e.providerAddressState,code:e.code,codeSystem:y.codeSystemConversion[e.codeSystem]}})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("div",{className:"healthInfoHeader"},"Request Info"),r.a.createElement("div",{className:"healthInfo"},Object.keys(this.state.requestInfo).map((function(t){return r.a.createElement("div",{key:t,className:"infoEntry"},r.a.createElement("span",{className:"infoTitle"},t),": ",e.state.requestInfo[t])}))))}}]),t}(n.Component),E=a(161),k=a.n(E),C=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={events:{Authorized:{status:!!a.props.timeline&&a.props.timeline[0],hovertext:"CRD gained authorization to access all necessary services"},Parsed:{status:!!a.props.timeline&&a.props.timeline[1],hovertext:"Request data parsed"},Hydrated:{status:!!a.props.timeline&&a.props.timeline[2],hovertext:"Prefetched associated data and added to request data"},"CQL Fetched":{status:!!a.props.timeline&&a.props.timeline[3],hovertext:"Retrieved relevant CQL"},"CQL Executed":{status:!!a.props.timeline&&a.props.timeline[4],hovertext:"Executed CQL using prefetched and request data"}}},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("div",{className:"errorDetailBox"},Object.keys(this.state.events).map((function(t,a){return r.a.createElement("div",{key:t},r.a.createElement("div",{className:"singleRow withNode"},r.a.createElement("div",{className:"timelineEvent"},r.a.createElement("span",{className:"labelFormat"},r.a.createElement(k.a,{content:e.state.events[t].hovertext,direction:"right",tagName:"span",useDefaultStyles:"true"},t))),r.a.createElement("a",{className:"node circle "+[e.state.events[t].status?"success":"failure"]},0!==a?r.a.createElement("span",{className:"topDivet"}):r.a.createElement("span",{className:"topDivet invis"}),a!==Object.keys(e.state.events).length-1?r.a.createElement("span",{className:"bottomDivet"}):null)),a!==Object.keys(e.state.events).length-1?r.a.createElement("div",{className:"singleRow"},r.a.createElement("div",{className:"timelineEvent emptyEdge"}),r.a.createElement("div",{className:"node edge"}," | ")):null)}))))}}]),t}(n.Component),j=(n.Component,function(e){function t(e){var a,n;for(Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={slideIn:"slideInStart",requestInfo:{},showRequestBody:!1,showResults:!1},a.showRequestBody=a.showRequestBody.bind(Object(f.a)(a)),a.showResults=a.showResults.bind(Object(f.a)(a)),a.resultsCount=0,a.topics="",n=0;n<a.props.data.topics.length;n++)null!=a.props.data.topics[n]&&(a.resultsCount=a.resultsCount+1,a.topics=0==n?a.props.data.topics[n]:a.topics+", "+a.props.data.topics[n]);return a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"showRequestBody",value:function(){this.setState((function(e){return{showRequestBody:!e.showRequestBody}}))}},{key:"showResults",value:function(){this.setState((function(e){return{showResults:!e.showResults}}))}},{key:"unfurlJson",value:function(e){var t=this,a={marginLeft:20};if(e)return Object.keys(e).map((function(n){return"access_token"===n?r.a.createElement("div",{className:"jsonData",key:n,style:a},r.a.createElement("span",{className:"elementKey"},n),": ",r.a.createElement("span",{className:"elementBody"},"-")):r.a.createElement("div",{className:"jsonData",key:n,style:a},r.a.createElement("span",{className:"elementKey"},n),": ",r.a.createElement("span",{className:"elementBody"},null===e[n]?"null":"object"===typeof e[n]?t.unfurlJson(e[n]):e[n]))}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("div",{className:"detailWindow",onClick:function(){e.state.showRequestBody&&e.setState({showRequestBody:!1}),e.state.showResults&&e.setState({showResults:!1})}},r.a.createElement("div",{className:"col1"},r.a.createElement("div",{className:"healthInfoBox"},r.a.createElement(g,{data:this.props.data}))),r.a.createElement("div",{className:"col1"},r.a.createElement(C,{timeline:this.props.data.timeline})),r.a.createElement("div",{className:"col1 processTime"},r.a.createElement("div",{className:"errorDetail "+[this.state.showRequestBody?"filled":"empty"],onClick:this.showRequestBody},"Show Request Body"),r.a.createElement("div",{className:"errorDetail "+[this.state.showResults?"filled":"empty"],onClick:this.showResults},"Topic Results ",r.a.createElement("span",null,"[ ",this.resultsCount," ]")))),this.state.showRequestBody?r.a.createElement("div",{className:"requestBody"},this.unfurlJson(JSON.parse(atob(this.props.data.requestBody)))):null,this.state.showResults?r.a.createElement("div",{className:"requestBody"},"\xa0\xa0Topics: ",this.topics):null)}}]),t}(n.Component)),O=function(e){function t(e){var a;Object(o.a)(this,t);var n=(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).props.data.timestamp;return n||(n=new Date),n=Object(b.a)(new Date(n),"yyyy-MM-dd   HH:mm:ss  O"),a.state={hookType:a.props.data.hookType,fhirVersion:a.props.data.fhirVersion,success:!!a.props.data.timeline&&a.props.data.timeline[4],timeStamp:n,viewDetails:!1},a.openDetails=a.openDetails.bind(Object(f.a)(a)),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"openDetails",value:function(){this.setState((function(e){return{viewDetails:!e.viewDetails}}))}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"requestEntry "+[this.state.success?"successRequest ":"failureRequest "]+[this.state.viewDetails?"active":""],onClick:this.openDetails},r.a.createElement("div",{className:"element timestamp"},this.state.timeStamp),r.a.createElement("div",{className:"element fhirversion"},this.state.fhirVersion),r.a.createElement("div",{className:"element hooktype"},this.state.hookType),r.a.createElement("div",{className:"element successElement"},this.state.success?"success":"failure")),this.state.viewDetails?r.a.createElement(j,{data:this.props.data}):null)}}]),t}(n.Component),w=a(18),x=Object(w.getBaseUrl)(),S=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={data:[],dataToShow:null,page:1,view:1},a.getPage=a.getPage.bind(Object(f.a)(a)),a.renderPageNumbers=a.renderPageNumbers.bind(Object(f.a)(a)),a.getData=a.getData.bind(Object(f.a)(a)),a.increaseView=a.increaseView.bind(Object(f.a)(a)),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.getData(),this.getPage(1)}},{key:"getData",value:function(){var e=Object(v.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(x+"api/requests",{method:"GET",headers:{Accept:"application/json"}}).then((function(e){return e.json()})).catch((function(e){console.log("Couldn't load data, make sure the server is running."),console.log("error=",e)}));case 2:(t=e.sent)&&(t.sort(this.compareTime),this.setState({data:t}),t.requestBody,this.getPage(1));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getPage",value:function(e){var t=15*(e-1);this.setState({dataToShow:this.state.data.slice(t,t+15)}),this.setState({page:e})}},{key:"renderPageNumbers",value:function(){for(var e=[],t=1;t<=Math.ceil(this.state.data.length/15);t++)e.push(t);return e}},{key:"compareTime",value:function(e,t){return e.timestamp<t.timestamp?1:e.timestamp>t.timestamp?-1:0}},{key:"increaseView",value:function(e){this.setState({view:this.state.view+e})}},{key:"render",value:function(){var e=this,t=this.state.view+9-1<this.state.data.length/15,a=1!=this.state.view;return window.scrollTo(0,0),r.a.createElement("div",{className:"fontSetter"},r.a.createElement("div",null,r.a.createElement("div",{className:"requestHeader fixed"},r.a.createElement("div",{className:"element timestamp"},"Timestamp"),r.a.createElement("div",{className:"element fhirversion"},"FHIR version"),r.a.createElement("div",{className:"element hooktype"},"Hook Type"),r.a.createElement("div",{className:"element successElement"},"Success Status"),r.a.createElement("div",{className:"pageTab"},this.state.page)),r.a.createElement("div",{className:"break"}),r.a.createElement("div",{className:"requestEntries"},this.state.dataToShow?this.state.dataToShow.map((function(e){return r.a.createElement(O,{data:e,key:e.timestamp})})):r.a.createElement("p",null))),r.a.createElement("div",{className:"pageNumber"},r.a.createElement("span",null,r.a.createElement("button",{className:"viewButton backwardView "+(a?"":"invisible"),onClick:function(){e.increaseView(1-e.state.view)}},"<<"),r.a.createElement("button",{className:"viewButton backwardView "+(a?"":"invisible"),onClick:function(){e.increaseView(-1)}},"<")),this.renderPageNumbers().map((function(t){if(t>=e.state.view&&t<e.state.view+9)return r.a.createElement("button",{key:t,className:"orderButton "+(t==e.state.view?"firstButton ":"")+[e.state.page===t?"active":""],onClick:function(){return e.getPage(t)}},t)})),r.a.createElement("span",null,r.a.createElement("button",{className:"viewButton forwardView "+(t?"":"invisible"),onClick:function(){e.increaseView(1)}},">"),r.a.createElement("button",{className:"viewButton forwardView "+(t?"":"invisible"),onClick:function(){e.increaseView(Math.ceil(e.state.data.length/15)-(e.state.view+9-1))}},">>"))))}}]),t}(n.Component),N=a(30),D=a(15),I=(a(206),a(23)),R=a.n(I),T=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={animationClasses:"animated animatedFadeInUp fadeInUp keyEntry",kid:a.props.kid,jwt:a.props.jwt,editMode:!1,showContent:!0,data:"text/json;charset=utf-8,"+encodeURIComponent(a.props.jwt)},a.updateContent=a.updateContent.bind(Object(f.a)(a)),a.handleChange=a.handleChange.bind(Object(f.a)(a)),a.deleteContent=a.deleteContent.bind(Object(f.a)(a)),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){try{var e=JSON.parse(this.state.jwt)}catch(n){e=this.state.jwt}try{var t=I.KEYUTIL.getKey(e),a=I.KEYUTIL.getJWKFromKey(t);this.setState({jwt:JSON.stringify(a)}),this.setState({data:"text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(a))})}catch(n){}}},{key:"handleChange",value:function(e){this.setState({jwt:e.target.value})}},{key:"updateContent",value:function(e){e.preventDefault(),this.setState({animationClasses:"keyEntry"}),console.log(this.state.animationClasses);try{var t=JSON.parse(this.state.jwt)}catch(i){t=this.state.jwt}try{var a=I.KEYUTIL.getKey(t),n=I.KEYUTIL.getJWKFromKey(a);this.setState({jwt:JSON.stringify(n)});var r=R.a.jws.JWS.getJWKthumbprint(n);r!=this.state.kid&&(this.props.updateIdCB(this.state.kid,r,n),this.setState({kid:r})),this.setState({data:"text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(n))})}catch(i){this.props.updateIdCB(this.state.kid,this.state.kid,this.state.jwt)}this.state.editMode?this.setState({editMode:!1}):this.setState({editMode:!0})}},{key:"deleteContent",value:function(){this.props.deleteCB(this.state.kid)}},{key:"render",value:function(){var e=this,t={animationDelay:this.props.delay};return this.state.showContent?r.a.createElement("div",null,r.a.createElement("div",{className:this.state.animationClasses+" "+this.props.extraClass,value:this.state.value,style:t},r.a.createElement("div",{className:"jwtContent"},r.a.createElement("form",{onSubmit:this.updateContent,className:"keyEntryForm"},r.a.createElement("div",{className:"kidBox"},"ID: ",this.state.kid),this.state.editMode?r.a.createElement("div",null,r.a.createElement("input",{value:this.state.jwt,className:"editInput",onChange:function(t){return e.handleChange(t)}})):r.a.createElement("div",{className:"keyData"},this.state.jwt))),r.a.createElement("div",{className:"buttonContent"},r.a.createElement("button",{className:"editingButton addButton "+this.props.extraClass,onClick:this.state.editMode?this.updateContent:function(){e.setState({editMode:!e.state.editMode})}},this.state.editMode?r.a.createElement("span",{className:"glyphicon glyphicon-remove"}):r.a.createElement("span",{className:"glyphicon glyphicon-pencil"})),r.a.createElement("button",{className:"editingButton deleteButton "+this.props.extraClass,onClick:this.deleteContent},r.a.createElement("span",{className:"glyphicon glyphicon-trash"})),r.a.createElement("a",{href:"data:"+this.state.data,download:this.state.kid+".json"},r.a.createElement("button",{className:"editingButton downloadButton "+this.props.extraClass},r.a.createElement("span",{className:"glyphicon glyphicon-download-alt"})))))):null}}]),t}(n.Component),B=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={kid:"",jwt:"",editMode:!0,generateKeyID:!1,uniqueKey:!0},a.updateContent=a.updateContent.bind(Object(f.a)(a)),a.handleChange=a.handleChange.bind(Object(f.a)(a)),a.deleteContent=a.deleteContent.bind(Object(f.a)(a)),a.generateKeyID=a.generateKeyID.bind(Object(f.a)(a)),a.submitContent=a.submitContent.bind(Object(f.a)(a)),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"handleChange",value:function(e,t){this.setState(Object(D.a)({},t,e.target.value)),"jwt"===t&this.state.generateKeyID&&this.setState({kid:this.getKeyID(e.target.value)})}},{key:"getKeyID",value:function(e){var t=null;try{t=JSON.parse(e)}catch(i){t=e}r="";try{var a=I.KEYUTIL.getKey(t),n=I.KEYUTIL.getJWKFromKey(a),r=R.a.jws.JWS.getJWKthumbprint(n)}catch(i){console.log(i)}return r}},{key:"generateKeyID",value:function(){this.state.generateKeyID||this.setState({kid:this.getKeyID(this.state.jwt)}),this.setState({generateKeyID:!this.state.generateKeyID})}},{key:"updateContent",value:function(e){try{var t=JSON.parse(this.state.jwt)}catch(i){t=this.state.jwt}try{var a=I.KEYUTIL.getKey(t),n=I.KEYUTIL.getJWKFromKey(a);this.setState({jwt:JSON.stringify(n)});var r=R.a.jws.JWS.getJWKthumbprint(n);this.setState({kid:r})}catch(i){}e.preventDefault(),this.state.editMode?this.setState({editMode:!1}):this.setState({editMode:!0})}},{key:"deleteContent",value:function(){console.log("deleting"),this.props.deleteCB(!1)}},{key:"submitContent",value:function(e){e.preventDefault(),this.props.isUnique(this.state.kid)?this.props.submitContent(this.state.kid,this.state.jwt):alert("Key ID must be unique")}},{key:"render",value:function(){var e=this,t={animationDelay:this.props.delay};return r.a.createElement("div",{id:"editEntry"},r.a.createElement("div",{className:"animated animatedFadeInUp fadeInUp keyEntry editEntry",value:this.state.value,style:t},r.a.createElement("div",{className:"jwtContent"},r.a.createElement("button",{id:"editDeleteButton",className:"editingButton",onClick:this.deleteContent},"X"),r.a.createElement("form",{onSubmit:this.submitContent},r.a.createElement("div",{className:"kidBox"},r.a.createElement("div",{className:"kidBox"},"Key ID: "),r.a.createElement("input",{value:this.state.kid,className:"editInput",onChange:function(t){return e.handleChange(t,"kid")}})),r.a.createElement("div",null,r.a.createElement("div",{className:"kidBox"},"Public Key: "),r.a.createElement("textarea",{value:this.state.jwt,className:"editInput jwtTextArea",onChange:function(t){return e.handleChange(t,"jwt")}}))),r.a.createElement("span",null,"Generate Key ID: "),r.a.createElement("button",{className:"editModeButton checkBox "+(this.state.generateKeyID?"checkBoxPressed":""),onClick:this.generateKeyID}),r.a.createElement("button",{className:"clickButton",onClick:this.submitContent},"Submit"))))}}]),t}(n.Component),M=Object(w.getBaseUrl)(),q=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).deleteContent=function(e){a.setState((function(t){var a=t.jwtJson;return console.log(a),{jwtJson:a.filter((function(t){return Object.keys(t)[0]!==e}))}}),(function(){a.deleteData(e)}))},a.exitNewItem=function(e){a.setState({createNew:!1}),a.setState({editing:""})},a.state={jwtJson:[],createNew:!1,editing:""},a.deleteContent=a.deleteContent.bind(Object(f.a)(a)),a.newItem=a.newItem.bind(Object(f.a)(a)),a.exitNewItem=a.exitNewItem.bind(Object(f.a)(a)),a.isUnique=a.isUnique.bind(Object(f.a)(a)),a.updateIdCB=a.updateIdCB.bind(Object(f.a)(a)),a.returnItem=a.returnItem.bind(Object(f.a)(a)),a.submitContent=a.submitContent.bind(Object(f.a)(a)),a.saveData=a.saveData.bind(Object(f.a)(a)),a.initData=a.initData.bind(Object(f.a)(a)),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=Object(v.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.doFetch){e.next=5;break}return e.next=3,fetch(M+"api/public",{method:"GET",headers:{Accept:"application/json"}}).then((function(e){return e.json()})).catch((function(e){console.log("Could not load data, make sure the server is running.")}));case 3:t=e.sent,this.initData(t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"saveData",value:function(){var e=Object(v.a)(p.a.mark((function e(t){var a,n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=Object.keys(t)[0],n=t[a],r={id:a,key:n},!this.props.doFetch){e.next=6;break}return e.next=6,fetch(M+"api/public",{method:"POST",headers:{Accept:"application/json",Content:"application/json"},body:JSON.stringify(r)}).then((function(e){console.log("Saved the data")})).catch((function(e){console.log("Could not save data")}));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteData",value:function(){var e=Object(v.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.doFetch){e.next=4;break}return e.next=3,fetch(M+"api/public/"+t,{method:"DELETE",headers:{Accept:"application/json",Content:"application/json"}}).then((function(e){console.log("Deleted the data")})).catch((function(e){console.log("Could not save data")}));case 3:case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"editData",value:function(){var e=Object(v.a)(p.a.mark((function e(t,a){var n,r,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Object.keys(a)[0],r=a[n],i={id:n,key:JSON.stringify(r)},!this.props.doFetch){e.next=7;break}return e.next=6,fetch(M+"api/public/"+t,{method:"PUT",headers:{Accept:"application/json",Contetn:"application/json"},body:JSON.stringify(i)}).then((function(e){console.log("Saved the data")})).catch((function(e){console.log("Could not save data")}));case 6:case 7:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"initData",value:function(e){if(e){var t=[];Object.keys(e).map((function(a){var n=e[a].id;t.push(Object(D.a)({},n,e[a].key))})),this.setState({jwtJson:t})}}},{key:"updateIdCB",value:function(e,t,a){var n=this,r=!0;this.state.jwtJson.map((function(t){JSON.stringify(t[e])==JSON.stringify(a)&&(r=!1)})),r&&this.setState((function(n){return{jwtJson:n.jwtJson.map((function(n){return Object.keys(n)[0]==e?(console.log(a),console.log(n[e]),Object(D.a)({},t,JSON.stringify(a))):n}))}}),(function(){return n.editData(e,Object(D.a)({},t,a))}))}},{key:"newItem",value:function(){this.setState({createNew:!0}),this.setState({editing:"editing"})}},{key:"isUnique",value:function(e){return 0===this.state.jwtJson.filter((function(t){return Object.keys(t)[0]==e})).length}},{key:"submitContent",value:function(e,t){var a=this;this.setState({createNew:!1}),this.setState({editing:""});var n=Object(D.a)({},e,t);this.setState((function(e){return{jwtJson:[n].concat(Object(N.a)(e.jwtJson))}}),(function(){a.saveData(Object(D.a)({},e,t))}))}},{key:"returnItem",value:function(){if(this.state.createNew)return r.a.createElement(B,{deleteCB:this.exitNewItem,isUnique:this.isUnique,submitContent:this.submitContent})}},{key:"render",value:function(){var e,t,a=this,n=0;return r.a.createElement("div",{className:"publicKeyInterface"},r.a.createElement("div",{className:"button-wrapper"},r.a.createElement("button",{id:"addButton",className:"newEntryButton",onClick:this.newItem},r.a.createElement("span",{className:"glyphicon glyphicon-plus-sign"}))),r.a.createElement("div",{className:"button-wrapper"},r.a.createElement("button",{className:"newEntryButton reloadButton",onClick:this.initData},r.a.createElement("span",{className:"glyphicon glyphicon-retweet"}))),r.a.createElement("div",{className:"borderDiv"}),this.returnItem(),this.state.jwtJson.map((function(i){return e=Object.keys(i)[0],n+=.2,t=i[e],r.a.createElement(T,{extraClass:a.state.editing,deleteCB:a.deleteContent,updateIdCB:a.updateIdCB,kid:e,delay:n+"s",jwt:t,key:e})})))}}]),t}(n.Component),L=(a(64),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={data:{}},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.data;Object.keys(e).forEach((function(t){null==e[t]&&(e[t]="-")})),this.setState({data:e})}},{key:"render",value:function(){return r.a.createElement("tr",null,r.a.createElement("td",null,this.state.data.readableTopic),r.a.createElement("td",null,this.state.data.payer),r.a.createElement("td",null,this.state.data.code),r.a.createElement("td",null,y.codeSystemConversion[this.state.data.codeSystem]),r.a.createElement("td",null,this.state.data.fhirVersion),r.a.createElement("td",null,r.a.createElement("a",{href:this.state.data.link},"download")))}}]),t}(n.Component)),P=Object(w.getBaseUrl)(),U=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={rules:{}},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.body.style.backgroundColor="white";var t=fetch(P+"api/data",{method:"GET",headers:{Accept:"application/json"}}).then((function(e){return e.json()})).then((function(t){console.log(t),e.setState({rules:t})})).catch((function(e){console.log(e),console.log("Couldn't load data, make sure the server is running.")}));console.log(t)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"dataTable"},r.a.createElement("form",{action:"/reload",method:"post"},r.a.createElement("div",{class:"spacer"}),r.a.createElement("span",{class:"reload"},r.a.createElement("input",{name:"vsac_api_key",type:"password",placeholder:"VSAC API KEY"}),r.a.createElement("input",{type:"submit",value:"Reload Data"}))),r.a.createElement("div",null,r.a.createElement("table",{className:"table-responsive table-striped table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("td",null,"Topic"),r.a.createElement("td",null,"Payor"),r.a.createElement("td",null,"Relevant Code"),r.a.createElement("td",null,"Code System"),r.a.createElement("td",null,"FHIR Version"),r.a.createElement("td",null,"Rule"))),r.a.createElement("tbody",null,this.state.rules instanceof Array?this.state.rules.map((function(t){return r.a.createElement(L,{data:t,key:t.id,home:e.props.home})})):null))))}}]),t}(n.Component),A=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={resource:{}},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.resource;Object.keys(e).forEach((function(t){null==e[t]&&(e[t]="-")})),this.setState({resource:e})}},{key:"render",value:function(){return r.a.createElement("tr",null,r.a.createElement("td",null,this.state.resource.id),r.a.createElement("td",null,this.state.resource.resourceType),r.a.createElement("td",null,this.state.resource.readableTopic),r.a.createElement("td",null,this.state.resource.fhirVersion),r.a.createElement("td",null,this.state.resource.filename),r.a.createElement("td",null,this.state.resource.url),r.a.createElement("td",null,r.a.createElement("a",{href:this.state.resource.link},"download")))}}]),t}(n.Component),J=Object(w.getBaseUrl)(),K=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={resources:{}},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.body.style.backgroundColor="white";var t=fetch(J+"api/fhir",{method:"GET",headers:{Accept:"application/json"}}).then((function(e){return e.json()})).then((function(t){console.log(t),e.setState({resources:t})})).catch((function(e){console.log(e),console.log("Couldn't load fhir data, make sure the server is running.")}));console.log(t)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"fhirTable"},r.a.createElement("div",null,r.a.createElement("table",{className:"table-responsive table-striped table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("td",null,"ID"),r.a.createElement("td",null,"Resource Type"),r.a.createElement("td",null,"Topic"),r.a.createElement("td",null,"Fhir Version"),r.a.createElement("td",null,"Filename"),r.a.createElement("td",null,"URL"),r.a.createElement("td",null,"Download"))),r.a.createElement("tbody",null,this.state.resources instanceof Array?this.state.resources.map((function(t){return r.a.createElement(A,{resource:t,key:t.id,home:e.props.home})})):null))))}}]),t}(n.Component),H=Object(w.getBaseUrl)(),F=Object(w.getHostOrg)(),V=[{name:"FHIR R4 endpoint",link:H+"r4/cds-services",description:"The provider systems would interact with the CDS Hooks endpoints. These endpoints provide the JSON descriptions of the CDS Hooks services."},{name:"Rules endpoint",link:H+"api/data",description:"Endpoint for retrieving and manipulating rules."},{name:"Requests endpoint",link:H+"api/requests",description:"Endpoint for retrieving the requests made to the server as JSON."},{name:"Public Key endpoint",link:H+"api/public",description:"Endpoint for retrieving keys from and adding keys to the server database"}],_=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={requestInfo:{}},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){document.body.style.marginLeft="15px"}},{key:"displayHostTest",value:function(){switch(F){case"AHRQ":return r.a.createElement("p",null,"This server hosts the prototype of the Documentation Requirement Lookup Service (DRLS) clinical decision support (CDS) service. The DRLS CDS Service is a software project that conforms to the implementation guides for ",r.a.createElement("a",{href:"http://build.fhir.org/ig/HL7/davinci-crd/"},"Coverage Requirements Discovery (CRD)")," and ",r.a.createElement("a",{href:"http://build.fhir.org/ig/HL7/davinci-dtr/"},"Documentation Templates and Rules (DTR)")," developed by the MITRE Corporation for the Centers for Medicare & Medicaid Services (CMS), and under the ",r.a.createElement("a",{href:"http://www.hl7.org/about/davinci/index.cfm?ref=common"},"Da Vinci Project")," within the ",r.a.createElement("a",{href:"http://www.hl7.org/"},"HL7 standards developing organization"),". It was developed in support of the ",r.a.createElement("a",{href:"https://www.cms.gov/Research-Statistics-Data-and-Systems/Monitoring-Programs/Medicare-FFS-Compliance-Programs/LookupServiceInitiative.html"},"DRLS Initiative")," led by CMS, with hosting provided by the ",r.a.createElement("a",{href:"https://www.ahrq.gov/"},"Agency for Healthcare Research and Quality (AHRQ)")," as part of an inter-agency collaboration. In addition, several DRLS CDS artifacts are being hosted on AHRQ\u2019s ",r.a.createElement("a",{href:"https://cds.ahrq.gov/"},"CDS Connect")," repository.",r.a.createElement("br",null),r.a.createElement("br",null),"CRD is implemented with ",r.a.createElement("a",{href:"https://cds-hooks.org/",target:"#"},"CDS Hooks"),". It returns responses to CRD queries based on a small database of example rules. The example rules can be managed through the ",r.a.createElement("a",{href:"/data"},"administrative interface"),".");case"HSPC":return r.a.createElement("p",null,"This server hosts the prototype of the Documentation Requirement Lookup Service (DRLS) clinical decision support (CDS) service. The DRLS CDS Service is a software project that conforms to the implementation guides for ",r.a.createElement("a",{href:"http://build.fhir.org/ig/HL7/davinci-crd/"},"Coverage Requirements Discovery (CRD)")," and ",r.a.createElement("a",{href:"http://build.fhir.org/ig/HL7/davinci-dtr/"},"Documentation Templates and Rules (DTR)")," developed by the MITRE Corporation for the Centers for Medicare & Medicaid Services (CMS), and under the ",r.a.createElement("a",{href:"http://www.hl7.org/about/davinci/index.cfm?ref=common"},"Da Vinci Project")," within the ",r.a.createElement("a",{href:"http://www.hl7.org/"},"HL7 standards developing organization"),". It was developed in support of the ",r.a.createElement("a",{href:"https://www.cms.gov/Research-Statistics-Data-and-Systems/Monitoring-Programs/Medicare-FFS-Compliance-Programs/LookupServiceInitiative.html"},"DRLS Initiative")," led by CMS, with hosting provided by the ",r.a.createElement("a",{href:"https://www.hspconsortium.org/"},"Healthcare Services Platform Consortium (HSPC)"),". In addition, several DRLS CDS artifacts are being hosted on ",r.a.createElement("a",{href:"https://www.ahrq.gov/"},"Agency for Healthcare Research and Quality (AHRQ)"),"\u2019s ",r.a.createElement("a",{href:"https://cds.ahrq.gov/"},"CDS Connect")," repository.",r.a.createElement("br",null),r.a.createElement("br",null),"CRD is implemented with ",r.a.createElement("a",{href:"https://cds-hooks.org/",target:"#"},"CDS Hooks"),". It returns responses to CRD queries based on a small database of example rules. The example rules can be managed through the ",r.a.createElement("a",{href:"/data"},"administrative interface"),".");default:return r.a.createElement("p",null,"CRD is implemented with ",r.a.createElement("a",{href:"https://cds-hooks.org/",target:"#"},"CDS Hooks"),". It returns responses to CRD queries based on a small database of example rules. The example rules can be managed through the ",r.a.createElement("a",{href:"/data"},"administrative interface"),".")}}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h1",{className:"header",id:"henlo"},"Coverage Requirements Discovery (CRD) Reference Implementation (RI)"),this.displayHostTest(),r.a.createElement("table",{className:"table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null),r.a.createElement("th",null,"URI"),r.a.createElement("th",null,"Description"))),r.a.createElement("tbody",null,V.map((function(e){return r.a.createElement("tr",{key:e.name},r.a.createElement("th",{scope:"row"},e.name),r.a.createElement("td",null,r.a.createElement("a",{href:e.link},e.link)),r.a.createElement("td",null,e.description))})))))}}]),t}(n.Component),W=a(55),z=a(420),Y=(a(127),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={serviceUri:"",clientId:"",clients:[]},a.baseUrl=Object(w.getBaseUrl)(),a.launch=a.launch.bind(Object(f.a)(a)),a.save=a.save.bind(Object(f.a)(a)),a.fetchClients=a.fetchClients.bind(Object(f.a)(a)),a.handleChange=a.handleChange.bind(Object(f.a)(a)),a.handleInput=a.handleInput.bind(Object(f.a)(a)),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch("".concat(this.baseUrl,"api/clients"),{method:"GET"}).then((function(e){return e.json()})).then((function(t){var a=Object(W.getUrlParameter)("iss");if(e.setState({clients:t}),console.log(t),a){var n=t.find((function(e){return e.iss===a}));n?e.launch(n.iss,n.client_id):e.setState({serviceUri:a})}}))}},{key:"fetchClients",value:function(){var e=this,t=Object(w.getBackend)();return fetch("".concat(t,"api/clients"),{method:"GET"}).then((function(e){return e.json()})).then((function(t){return e.setState({clients:t})}))}},{key:"save",value:function(e,t){fetch("".concat(this.baseUrl,"api/clients"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({iss:e,client_id:t})})}},{key:"launch",value:function(e,t){localStorage.setItem("lastAccessedServiceUri",e);var a,n=["launch","user/Observation.read","user/Patient.read","patient/Observation.read","patient/Patient.read","patient/Coverage.read","patient/Condition.read","user/Practitioner.read"].join(" "),r=Math.round(1e8*Math.random()).toString(),i=(window.location.protocol+"//"+window.location.host+window.location.pathname).replace("launch","index"),s=e+"/metadata?_format=json",o=new XMLHttpRequest;o.open("GET",s),o.setRequestHeader("Content-Type","application/json"),o.setRequestHeader("Accept","application/json"),o.onload=function(){if(200===o.status){try{a=JSON.parse(o.responseText)}catch(c){return void(document.body.innerText="Unable to parse conformance statement.")}!function(a){var s,o;a.rest[0].security.extension.filter((function(e){return"http://fhir-registry.smarthealthit.org/StructureDefinition/oauth-uris"===e.url}))[0].extension.forEach((function(e){"authorize"===e.url?s=e.valueUri:"token"===e.url&&(o=e.valueUri)})),sessionStorage[r]=JSON.stringify({client_id:t,serviceUri:e,redirect_uri:i,tokenUri:o});var c=s+"?response_type=code&client_id="+encodeURIComponent(t)+"&scope="+encodeURIComponent(n)+"&redirect_uri="+encodeURIComponent(i)+"&aud="+encodeURIComponent(e)+"&state="+r;console.log(c),window.location.href=c}(a)}else{var s="Conformance statement request failed. Returned status: "+o.status;document.body.innerText=s}},o.send()}},{key:"handleChange",value:function(e,t){var a=t.value,n=JSON.parse(a);this.setState({serviceUri:n.iss,clientId:n.client_id})}},{key:"handleInput",value:function(e,t){this.setState(Object(D.a)({},t,e.target.value))}},{key:"renderClients",value:function(){var e=this.state.clients.map((function(e){return{key:e.client_id,value:JSON.stringify(e),text:"".concat(e.iss," - ").concat(e.client_id)}})),t={iss:this.state.serviceUri,client_id:this.state.clientId};return r.a.createElement("div",{className:"clientDropdown"},r.a.createElement("div",null,"Saved Clients: "),r.a.createElement(z.a,{placeholder:"Select client",fluid:!0,search:!0,selection:!0,onChange:this.handleChange,value:JSON.stringify(t),options:e}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,this.renderClients(),r.a.createElement("div",null,"ISS:",r.a.createElement("input",{className:"client-input",value:this.state.serviceUri,onChange:function(t){e.handleInput(t,"serviceUri")}})),r.a.createElement("div",null,"Client Id:",r.a.createElement("input",{className:"client-input",value:this.state.clientId,onChange:function(t){e.handleInput(t,"clientId")}})),r.a.createElement("button",{variant:"Primary",onClick:function(){e.launch(e.state.serviceUri,e.state.clientId)}},"Launch!"),r.a.createElement("button",{variant:"Primary",onClick:function(){e.save(e.state.serviceUri,e.state.clientId)}},"Save Client"))}}]),t}(n.Component)),G=a(56),Q=a(21),X=a(411),Z=Object(X.a)((function(e){return{inputs:{marginTop:"15px",height:"310px"},resourceBar:{border:"1px solid black",borderRadius:"15px",height:"40px",padding:"9px",transition:"height .5s",overflow:"hidden"},openBar:{height:"350px"},genderBox:{display:"inline-block",borderRadius:"5px",width:"120px",padding:"0 15px 15px 15px"},ageBox:{marginLeft:"15px",display:"inline-block"},stateOptions:{marginLeft:"15px",width:"160px"},menu:{position:"fixed",zIndex:1e3,top:"20%",left:"35%",height:"400px",minWidth:"400px",backgroundColor:"white",border:"1px solid #444",borderRadius:"5px",float:"left"},backdrop:{position:"fixed",height:"100%",width:"100%",top:0,left:0,zIndex:999,backgroundColor:"#999A"},loadButton:{marginTop:"15px"},menuHeader:{position:"fixed",backgroundColor:"white",zIndex:1002,padding:"5px",height:"30px",width:"385px",borderBottom:"1px solid black"},jsonInput:{float:"right"},orgBox:{float:"left"}}}),{name:"index",index:1}),$=a(424),ee=a(426),te=a(429),ae=a(414),ne=a(373),re=a(430),ie=a(422),se=a(416),oe=a(428);function ce(e){var t=Z(),a=e.callback,n=e.state,i=e.label,s=e.options;return r.a.createElement(r.a.Fragment,null,r.a.createElement(ae.a,{className:t.stateOptions},r.a.createElement(se.a,{id:"demo-simple-select-label"},i),r.a.createElement(ie.a,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:n||"",onChange:a},s.map((function(e){return r.a.createElement(oe.a,{key:e.key,value:e.value},e.text)})),r.a.createElement(oe.a,{value:""},r.a.createElement("em",null,"None")))))}var le=a(20),ue=a(169),de=a(164),he=a.n(de);function me(e){var t=Z(),a=e.callback,i=e.placeholder,s=Object(n.useState)(!1),o=Object(le.a)(s,2),c=o[0],l=o[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:t.jsonInput},c?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:function(){l(!1)}},"hide"),r.a.createElement(ue.a,{id:"ex2",placeholder:i,locale:he.a,height:"280px",onChange:a})):r.a.createElement("button",{onClick:function(){l(!0)}}," Edit Json ")))}function pe(e){var t=Z(),a=e.callback,n=e.patient,i=function(e,t){a("patient",e,t)},s=function(){var e=n.birthDate,t=new Date,a=new Date(e),r=t.getFullYear()-a.getFullYear(),i=t.getMonth()-a.getMonth();return(i<0||0===i&&t.getDate()<a.getDate())&&r--,r},o=function(e){var t=function(e){var t=new Date,a=t.getFullYear();if(e){var n=new Date(a-e,t.getMonth(),t.getDate()),r=new Intl.DateTimeFormat("en",{year:"numeric"}).format(n),i=new Intl.DateTimeFormat("en",{month:"2-digit"}).format(n),s=new Intl.DateTimeFormat("en",{day:"2-digit"}).format(n);return"".concat(r,"-").concat(i,"-").concat(s)}}(e.target.value);i("birthDate",t)};return r.a.createElement("div",null,r.a.createElement("div",{className:t.genderBox},r.a.createElement(ae.a,{component:"fieldset"},r.a.createElement(ne.a,{component:"legend"},"Gender"),r.a.createElement(ee.a,{"aria-label":"gender",name:"gender1",value:n.gender||"",onChange:function(e){i("gender",e.target.value)}},r.a.createElement(te.a,{value:"female",control:r.a.createElement($.a,null),label:"Female"}),r.a.createElement(te.a,{value:"male",control:r.a.createElement($.a,null),label:"Male"}),r.a.createElement(te.a,{value:"other",control:r.a.createElement($.a,null),label:"Other"})))),r.a.createElement("div",{className:t.ageBox},r.a.createElement(re.a,{id:"outlined-number",label:"Age",type:"number",style:{width:"60px"},InputLabelProps:{shrink:!0},value:s()||"",onChange:o})),r.a.createElement(ce,{callback:function(e){var t=[{use:"home",type:"both",state:e.target.value}];i("address",t)},state:n.address?n.address[0].state:"",label:"State",element:"address",options:Q.stateOptions}),r.a.createElement(me,{callback:function(e){e.jsObject&&a("patient","resource",e.jsObject)},placeholder:n}))}function ve(e){var t=Z(),a=Object(n.useState)(!1),i=Object(le.a)(a,2),s=(i[0],i[1],e.callback),o=e.coverage,c=e.organization,l=(o.classValue,o.type,o.orgName,function(e,t){s("coverage",e,t)}),u=function(){if(c.name)return c.name};return console.log(u()),r.a.createElement("div",null,r.a.createElement("div",{style:{display:"inline-block"}},r.a.createElement(re.a,{id:"outlined-number",label:"Class Value",type:"text",style:{width:"auto"},InputLabelProps:{shrink:!0},value:function(){if(o.class&&o.class.length>0)return o.class[0].value}()||"",onChange:function(e){if(o.class&&o.class.length>0){var t=Object(G.a)({},o.class[0]);t.value=e.target.value,l("class",[t])}else{var a=[{type:{system:"http://hl7.org/fhir/coverage-class"},value:e.target.value}];l("class",a)}}}),r.a.createElement(ce,{callback:function(e){if(o.class&&o.class.length>0){var t=Object(G.a)({},o.class[0]);t.type={system:"http://hl7.org/fhir/coverage-class",code:e.target.value},l("class",[t])}else{var a=[{type:{system:"http://hl7.org/fhir/coverage-class",code:e.target.value}}];l("class",a)}},state:function(){if(o.class&&o.class.length>0&&o.class[0].type)return o.class[0].type.code}(),label:"Code",element:"type",options:Q.coverageCodes}),r.a.createElement("hr",null),r.a.createElement("div",{className:t.orgBox},"Organization",r.a.createElement("div",null,r.a.createElement(ce,{callback:function(e){var t,a;t="name",a=e.target.value,s("coverageOrg",t,a)},state:u(),label:"Name",element:"name",options:Q.organizations})))),r.a.createElement(me,{callback:function(e){e.jsObject&&(s("coverage","resource",e.jsObject.coverage),s("coverageOrg","resource",e.jsObject.organization))},placeholder:{coverage:o,organization:c}}))}var fe=a(39),be=a.n(fe),ye=a(72),ge=a.n(ye),Ee=a(165),ke=a.n(Ee),Ce=a(118),je=a.n(Ce),Oe=a(2),we=a.n(Oe),xe=a(119),Se=a.n(xe),Ne=a(166),De=a.n(Ne),Ie=(a(318),we.a.bool,we.a.object,we.a.func.isRequired,we.a.string,we.a.string,we.a.string,we.a.object,function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).launchLink=a.launchLink.bind(Object(f.a)(a)),a.launchSource=a.launchSource.bind(Object(f.a)(a)),a.renderSource=a.renderSource.bind(Object(f.a)(a)),a.modifySmartLaunchUrls=a.modifySmartLaunchUrls.bind(Object(f.a)(a)),a.retrieveLaunchContext=a.retrieveLaunchContext.bind(Object(f.a)(a)),a.exitSmart=a.exitSmart.bind(Object(f.a)(a)),a.state={value:"",smartLink:"",response:{}},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){return JSON.stringify(e.response)!==JSON.stringify(this.state.response)||this.state.smartLink!==t.smartLink}},{key:"takeSuggestion",value:function(e,t){this.props.isDemoCard||(e.label?(e.uuid&&Se()({method:"POST",url:"".concat(t,"/analytics/").concat(e.uuid),data:{}}),this.props.takeSuggestion(e)):console.error("There was no label on this suggestion",e))}},{key:"launchSource",value:function(e){e.preventDefault()}},{key:"exitSmart",value:function(e){this.setState({smartLink:""})}},{key:"launchLink",value:function(e,t){if(!this.props.isDemoCard){if(e.preventDefault(),t.error)return;window.open(t.url,"_blank")}}},{key:"modifySmartLaunchUrls",value:function(e){var t=this;if(!this.props.isDemoCard)return e.links.map((function(e){var a=Object.assign({},e);return"smart"!==e.type||!t.props.fhirAccessToken&&!t.props.ehrLaunch||t.state.smartLink?"smart"===e.type&&(e.url.indexOf("?")<0?a.url+="?":a.url+="&"):t.retrieveLaunchContext(a,t.props.fhirAccessToken,t.props.patientId,t.props.fhirServerUrl,t.props.fhirVersion).then((function(e){return a=e})),a}))}},{key:"retrieveLaunchContext",value:function(e,t,a,n,r){return new Promise((function(r,i){var s=t?{Accept:"application/json",Authorization:"Bearer ".concat(t.access_token)}:{Accept:"application/json"},o={patient:a};e.appContext&&(o.appContext=e.appContext),Se()({method:"post",url:"".concat(n,"/_services/smart/Launch"),headers:s,data:{launchUrl:e.url,parameters:o}}).then((function(t){return t.data&&Object.prototype.hasOwnProperty.call(t.data,"launch_id")?(e.url.indexOf("?")<0?e.url+="?":e.url+="&",e.url+="launch=".concat(t.data.launch_id),e.url+="&iss=".concat(n),r(e)):(console.error("FHIR server endpoint did not return a launch_id to launch the SMART app. See network calls to the Launch endpoint for more details"),e.error=!0,i(e))})).catch((function(t){return console.error("Cannot grab launch context from the FHIR server endpoint to launch the SMART app. See network calls to the Launch endpoint for more details",t),e.error=!0,i(e)}))}))}},{key:"renderSource",value:function(e){var t,a=this;return e.label?(e.icon&&(t=r.a.createElement("img",{className:be.a["card-icon"],src:e.icon,alt:"Could not fetch icon",width:"100",height:"100"})),this.props.isDemoCard?r.a.createElement("div",{className:be.a["card-source"]},"Source:",r.a.createElement("a",{className:be.a["source-link"],href:"#",onClick:function(e){return a.launchSource(e)}},e.label),t):r.a.createElement("div",{className:be.a["card-source"]},"Source: ",r.a.createElement("a",{className:be.a["source-link"],href:e.url||"#",onClick:function(e){return a.launchSource(e)}},e.label),t)):null}},{key:"render",value:function(){var e=this,t={info:0,warning:1,"hard-stop":2,error:3},a={info:"#0079be",warning:"#ffae42","hard-stop":"#c00",error:"#333"},n=[];return null!=this.state.response&&null!=this.state.response.cards&&this.state.response.cards.sort((function(e,a){return t[a.indicator]-t[e.indicator]})).forEach((function(t,i){var s,o,c=JSON.parse(JSON.stringify(t)),l=r.a.createElement(je.a,{fontSize:18,weight:700,color:a[c.indicator]},c.summary),u=c.source&&Object.keys(c.source).length?e.renderSource(c.source):"",d=c.detail?r.a.createElement("div",{style:{color:a.info}},r.a.createElement(De.a,{source:c.detail})):r.a.createElement(je.a,{color:"grey"},"None");c.suggestions&&(s=c.suggestions.map((function(t,a){return r.a.createElement(ge.a,{key:a,onClick:function(){return e.takeSuggestion(t,c.serviceUrl)},text:t.label,variant:ge.a.Opts.Variants.EMPHASIS})}))),c.links&&(c.links=e.modifySmartLaunchUrls(c)||c.links,o=c.links.map((function(t,a){return r.a.createElement(ge.a,{key:a,onClick:function(a){return e.launchLink(a,t)},text:t.label,variant:ge.a.Opts.Variants["DE-EMPHASIS"]})})));var h={marginBottom:"2px",color:"black"},m=r.a.createElement(ke.a,{key:i,className:"decision-card alert-info"},r.a.createElement("h4",{style:h},"Summary"),r.a.createElement("div",null,l),r.a.createElement("h4",{style:h},"Details"),r.a.createElement("div",null,d),r.a.createElement("br",null),r.a.createElement("div",null,u),r.a.createElement("div",{className:be.a["suggestions-section"]},s),r.a.createElement("div",{className:be.a["links-section"]},o));n.push(m)})),0===n.length?r.a.createElement("div",null,r.a.createElement("div",{className:"decision-card alert-warning"},"No Cards")):r.a.createElement("div",null,r.a.createElement("div",null,n))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return JSON.stringify(e.response)!==JSON.stringify(t.response)?{response:e.response}:null}}]),t}(n.Component));function Re(e){var t=Z(),a=e.title,i=e.Fragment,s=(e.callback,Object(n.useState)(!1)),o=Object(le.a)(s,2),c=o[0],l=o[1],u=c?"".concat(t.resourceBar," ").concat(t.openBar):t.resourceBar;return r.a.createElement("div",{className:u},r.a.createElement("div",{onClick:function(){l(!c)}},a),r.a.createElement("hr",{style:{marginTop:"9px"}}),r.a.createElement("div",{className:t.inputs},i))}a(319);function Te(e){var t=Z(),a=e.callback,i=e.practitioner,s=e.role,o=e.org,c=e.location,l=Object(n.useState)(!1),u=Object(le.a)(l,2);u[0],u[1];return r.a.createElement("div",null,r.a.createElement("div",{style:{display:"inline-block"}},r.a.createElement(ce,{callback:function(e){var t={line:["100 Good St"],city:"Bedford",state:e.target.value};a("practitionerLocation","address",t)},state:function(){if(c.address)return c.address.state}(),element:"state",label:"State",options:Q.stateOptions}),r.a.createElement("hr",null),r.a.createElement("div",{className:t.orgBox},"Organization",r.a.createElement("div",null,r.a.createElement(re.a,{id:"outlined-number",label:"Name",type:"text",style:{width:"auto"},InputLabelProps:{shrink:!0},value:o.name||"",onChange:function(e){a("practitionerOrg","name",e.target.value)}})))),r.a.createElement(me,{callback:function(e){e.jsObject&&(a("practitioner","resource",e.jsObject.practitioner),a("practitionerOrg","resource",e.jsObject.organization),a("practitionerRole","resource",e.jsObject.practitionerRole),a("practitionerLocation","resource",e.jsObject.location))},placeholder:{practitioner:i,practitionerRole:s,organization:o,location:c}}))}function Be(e){Z();var t=e.callback,a=e.deviceRequest,n=function(e,a){t("deviceRequest",e,a)},i=function(){if(a.codeCodeableConcept&&a.codeCodeableConcept.coding&&a.codeCodeableConcept.coding.length>0)return a.codeCodeableConcept.coding[0].code},s=function(e){if(a.codeCodeableConcept&&a.codeCodeableConcept.coding&&a.codeCodeableConcept.coding[0].system){var t={coding:[{system:a.codeCodeableConcept.coding[0].system,code:e.target.value}]};n("codeCodeableConcept",t)}else if(a.codeCodeableConcept&&a.codeCodeableConcept.coding){var r={coding:[{code:e.target.value}]};n("codeCodeableConcept",r)}};return r.a.createElement("div",null,r.a.createElement("div",{style:{display:"inline-block"}},r.a.createElement(ce,{callback:function(e){var t={coding:[{system:e.target.value}]};n("codeCodeableConcept",t)},state:function(){if(a.codeCodeableConcept&&a.codeCodeableConcept.coding&&a.codeCodeableConcept.coding.length>0)return a.codeCodeableConcept.coding[0].system}(),label:"CodeSystem",element:"system",options:Q.codeSystems}),function(){var e=[];if(a.codeCodeableConcept&&a.codeCodeableConcept.coding){var t=a.codeCodeableConcept.coding[0].system;"https://bluebutton.cms.gov/resources/codesystem/hcpcs"===t?e=Q.hcpcsCodes:"http://www.ama-assn.org/go/cpt"===t?e=Q.cptCodes:"http://www.nlm.nih.gov/research/umls/rxnorm"===t&&(e=Q.rxNormCodes)}return r.a.createElement(ce,{callback:s,state:i(),label:"Code",element:"code",options:e})}()),r.a.createElement(me,{callback:function(e){e.jsObject&&t("deviceRequest","resource",e.jsObject)},placeholder:a}))}var Me=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={token:"",params:{},patients:[],patient:{resourceType:"Patient",id:"example1"},coverage:{resourceType:"Coverage",id:"example2",beneficiary:{reference:"Patient/example1"},status:"active",class:[],payor:[{reference:"Organization/covOrg1"}]},coverageOrg:{resourceType:"Organization",id:"covOrg1"},practitioner:{resourceType:"Practitioner",id:"example3"},practitionerRole:{resourceType:"PractitionerRole",id:"role1",practitioner:{reference:"Practitioner/example3"},location:[{reference:"Location/loc1"}],"organization ":{reference:"Organization/pracOrg1"}},practitionerLocation:{resourceType:"Location",id:"loc1",address:{line:["100 Good St"],city:"Bedford",postalCode:"01730"}},practitionerOrg:{resourceType:"Organization",id:"pracOrg1"},deviceRequest:{resourceType:"DeviceRequest",id:"example4",meta:{profile:["http://hl7.org/fhir/us/davinci-crd/R4/StructureDefinition/profile-devicerequest-r4"]},insurance:[{reference:"Coverage/example2"}],status:"draft",subject:{reference:"Patient/example1"},performer:{reference:"Practitioner/example3"},intent:"original-order"}},a.handleFieldChange=a.handleFieldChange.bind(Object(f.a)(a)),a.makePatientResource=a.makePatientResource.bind(Object(f.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(f.a)(a)),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"handleFieldChange",value:function(e,t,a){"resource"===t?this.setState(Object(D.a)({},e,a)):this.setState((function(n){return Object(D.a)({},e,Object(G.a)({},n[e],Object(D.a)({},t,a)))}))}},{key:"componentDidMount",value:function(){var e=Object(W.getUrlParameter)("state"),t=Object(W.getUrlParameter)("code"),a=JSON.parse(sessionStorage[e]),n=a.tokenUri,r=a.client_id,i=a.serviceUri,s=a.redirect_uri;this.setState({serviceUri:i});var o={code:t,grant_type:Q.grant_type,redirect_uri:s,client_id:r},c=Object(W.makeUrlParams)(o);this.makeTokenRequest(n,c,i)}},{key:"handleSubmit",value:function(){var e=this,t=[this.state.patient,this.state.deviceRequest,this.state.coverage,this.state.practitioner,this.state.practitionerRole,this.state.practitionerLocation,this.state.practitionerOrg,this.state.coverageOrg];t=t.map((function(e){return{resource:e}}));var a=Object(w.getBaseUrl)(),n=function(e,t,a,n,r,i,s){var o={hookInstance:"d1577c69-dfbe-44ad-ba6d-3e05e953b2ea",fhirServer:a,hook:s,fhirAuthorization:{access_token:n.access_token,token_type:"Bearer",expires_in:300,scope:"patient/Patient.read patient/Observation.read",subject:"cds-service4"},context:{userId:"Practitioner/example",patientId:t.id,encounterId:"enc89284"}};return"order-review"===s?o.context.orders={resourceType:"Bundle",entry:[e]}:"order-select"===s?(o.context.draftOrders={resourceType:"Bundle",entry:[e]},o.context.selections=[e.resourceType+"/"+e.id]):"order-sign"===s&&(o.context.draftOrders={resourceType:"Bundle",entry:[e]}),i&&(console.log(r),"DeviceRequest"===e.resourceType?o.prefetch={deviceRequestBundle:{resourceType:"Bundle",type:"collection",entry:r}}:"ServiceRequest"===e.resourceType?o.prefetch={serviceRequestBundle:{resourceType:"Bundle",type:"collection",entry:r}}:"MedicationRequest"===e.resourceType?o.prefetch={medicationRequestBundle:{resourceType:"Bundle",type:"collection",entry:r}}:"MedicationDispense"===e.resourceType&&(o.prefetch={medicationDispenseBundle:{resourceType:"Bundle",type:"collection",entry:r}})),console.log(o),console.log("--------- r4"),o}(this.state.deviceRequest,this.state.patient,this.state.serviceUri,this.state.token,t,!0,"order-sign");fetch("".concat(a,"r4/cds-services/order-sign-crd"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then((function(t){t.json().then((function(t){console.log(t),t&&t.status?console.log(t):(console.log(t),e.setState({response:t}))}))})).catch((function(e){return console.log(e)}))}},{key:"makeTokenRequest",value:function(e,t,a){var n=this;fetch(e,{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",body:t}).then((function(e){return e.json()})).then((function(e){var t=e.access_token;n.setState({token:t});fetch("".concat(a,"/Patient"),{headers:{Authorization:"Bearer ".concat(t)}}).then((function(e){return e.json()})).then((function(e){n.setState({patients:e.entry})}))}))}},{key:"makePatientResource",value:function(){var e=Object(G.a)({},this.state.patient);return e.gender=this.state.patient.gender,e.birthDate=this.getApproxBirthdate(this.state.patient.age),e.address=[{use:"home",type:"both",state:this.state.patient.state}],e}},{key:"renderPatients",value:function(e){console.log("hello");var t=e.map((function(e){return{key:e.fullUrl,value:e.resource.id,text:e.resource.id}}));return r.a.createElement(z.a,{placeholder:"Select client",fluid:!0,search:!0,selection:!0,options:t})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"left"},r.a.createElement(Re,{title:"Patient",Fragment:r.a.createElement(pe,{callback:this.handleFieldChange,patient:this.state.patient})}),r.a.createElement(Re,{title:"Coverage",Fragment:r.a.createElement(ve,{callback:this.handleFieldChange,coverage:this.state.coverage,organization:this.state.coverageOrg})}),r.a.createElement(Re,{title:"Practitioner",Fragment:r.a.createElement(Te,{callback:this.handleFieldChange,practitioner:this.state.practitioner,role:this.state.practitionerRole,org:this.state.practitionerOrg,location:this.state.practitionerLocation})}),r.a.createElement(Re,{title:"Device Request",Fragment:r.a.createElement(Be,{callback:this.handleFieldChange,deviceRequest:this.state.deviceRequest})}),r.a.createElement("button",{className:"submitButton",onClick:this.handleSubmit},"Submit")),r.a.createElement("div",{className:"right"},r.a.createElement(Ie,{isDemoCard:!0,response:this.state.response})))}}]),t}(n.Component),qe=a(427),Le=function(){return r.a.createElement("div",null,r.a.createElement(q,{doFetch:!0}))},Pe=Object(w.getBaseUrl)(),Ue=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=Pe,t=Pe+"public",a=Pe+"requests",n=Pe+"data",i=Pe+"fhirview",s=Pe+"launch",o=Pe+"index";return r.a.createElement("div",null,r.a.createElement("nav",{className:"navbar navbar-fixed-top headerEntry"},r.a.createElement("div",{className:"container padHelp"},r.a.createElement("span",{className:"navbar-brand headerIcon"}," ",r.a.createElement("span",{className:"glyphicon glyphicon-fire"})),r.a.createElement("a",{className:"navbar-brand headerLink "+(this.props.location.pathname==e?"active":""),href:e},"Home"),r.a.createElement("a",{className:"navbar-brand headerLink "+(this.props.location.pathname==t?"active":""),href:t},"Keys"),r.a.createElement("a",{className:"navbar-brand headerLink "+(this.props.location.pathname==n?"active":""),href:n},"Rules"),r.a.createElement("a",{className:"navbar-brand headerLink "+(this.props.location.pathname==i?"active":""),href:i},"FHIR"),r.a.createElement("a",{className:"navbar-brand headerLink "+(this.props.location.pathname==a?"active":""),href:a},"Log"))),r.a.createElement(h.a,{exact:!0,path:e,component:_}),r.a.createElement(h.a,{path:t,component:Le}),r.a.createElement(h.a,{path:a,component:S}),r.a.createElement(h.a,{path:n,component:U}),r.a.createElement(h.a,{path:i,component:K}),r.a.createElement(h.a,{path:s,component:Y}),r.a.createElement(h.a,{path:o,component:Me}))}}]),t}(n.Component),Ae=Object(qe.a)(Ue),Je=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Ke(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var He=a(423);s.a.render(r.a.createElement(He.a,null,r.a.createElement(Ae,null)),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("","/service-worker.js");Je?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Ke(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):Ke(e)}))}}()},39:function(e,t,a){},55:function(e,t){e.exports={getUrlParameter:function(e){for(var t=window.location.search.substring(1).split("&"),a=0;a<t.length;a++){var n=t[a].split("=");if(n[0]===e){var r=n[1].replace(/\+/g,"%20");return decodeURIComponent(r)}}},makeUrlParams:function(e){var t=[];return Object.keys(e).forEach((function(a){t.push("".concat(a,"=").concat(e[a]))})),t.join("&")}}},63:function(e,t,a){},64:function(e,t,a){},71:function(e,t){e.exports.codeSystemConversion={"http://www.ama-assn.org/go/cpt":"CPT","https://bluebutton.cms.gov/resources/codesystem/hcpcs":"HCPCS","http://www.nlm.nih.gov/research/umls/rxnorm":"RxNorm"}},77:function(e,t,a){}},[[190,1,2]]]);
//# sourceMappingURL=main.ad808a27.chunk.js.map